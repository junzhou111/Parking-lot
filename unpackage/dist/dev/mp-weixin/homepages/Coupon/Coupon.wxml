<view class="Coupon"><view class="inputbox"><view class="input"><u--input bind:input="__e" vue-id="5fcb28c2-1" adjustPosition="{{true}}" placeholder="搜索" prefixIcon="search" prefixIconStyle="font-size: 22px;color: #909399" value="{{searchvalue}}" data-event-opts="{{[['^input',[['__set_model',['','searchvalue','$event',[]]]]]]}}" bind:__l="__l"></u--input></view><view class="inputbtn"><button data-event-opts="{{[['tap',[['e0',['$event']]]]]}}" class="bt" bindtap="__e">新增</button><button data-event-opts="{{[['tap',[['search',['$event']]]]]}}" class="bt" bindtap="__e">搜索</button><button data-event-opts="{{[['tap',[['reset',['$event']]]]]}}" class="bt" bindtap="__e">重置</button></view></view><u-popup vue-id="5fcb28c2-2" show="{{newaddshow}}" mode="top" data-event-opts="{{[['^close',[['newaddclose']]],['^open',[['newaddopen']]]]}}" bind:close="__e" bind:open="__e" bind:__l="__l" vue-slots="{{['default']}}"><view class="fromview"><scroll-view scroll-y="true"><view class="scrollbox"><input class="calendarinput" type="text" placeholder="商家名称" data-event-opts="{{[['input',[['__set_model',['','MerchantName','$event',[]]],['changeValue',['$event']]]]]}}" value="{{MerchantName}}" bindinput="__e"/><scroll-view scroll-y="true"><view class="MerchantNamebox"><block wx:for="{{MerchantNamelist}}" wx:for-item="item" wx:for-index="index" wx:key="index"><view data-event-opts="{{[['tap',[['changeMerchantName',['$0'],[[['MerchantNamelist','',index]]]]]]]}}" class="MerchantNamebox-item" bindtap="__e"><text>{{item.name}}</text><text>{{item.type==0?'业主/车主':item.type==1?'家属':item.type==2?'租户':item.type==3?'工作人员':'APP注册用户'}}</text></view></block></view></scroll-view><u-action-sheet vue-id="{{('5fcb28c2-3')+','+('5fcb28c2-2')}}" actions="{{CouponType.list}}" title="{{CouponType.title}}" cancelText="取消" show="{{CouponType.show}}" data-event-opts="{{[['^select',[['CouponTypeClick']]],['^close',[['e1']]]]}}" bind:select="__e" bind:close="__e" bind:__l="__l"></u-action-sheet><view data-event-opts="{{[['tap',[['e2',['$event']]]]]}}" class="calendarinput" bindtap="__e"><text>{{CouponType.value}}</text><u-icon vue-id="{{('5fcb28c2-4')+','+('5fcb28c2-2')}}" size="20" name="arrow-down" bind:__l="__l"></u-icon></view><u-datetime-picker class="vue-ref" vue-id="{{('5fcb28c2-5')+','+('5fcb28c2-2')}}" show="{{startshow}}" mode="datetime" data-ref="datetimePicker" value="{{startvalue}}" data-event-opts="{{[['^close',[['e3']]],['^cancel',[['e4']]],['^confirm',[['startconfirm']]],['^input',[['__set_model',['','startvalue','$event',[]]]]]]}}" bind:close="__e" bind:cancel="__e" bind:confirm="__e" bind:input="__e" bind:__l="__l"></u-datetime-picker><view data-event-opts="{{[['tap',[['e5',['$event']]]]]}}" class="calendarinput" bindtap="__e"><text>生效时间</text><u-icon vue-id="{{('5fcb28c2-6')+','+('5fcb28c2-2')}}" size="25" name="calendar" bind:__l="__l"></u-icon></view><u-datetime-picker class="vue-ref" vue-id="{{('5fcb28c2-7')+','+('5fcb28c2-2')}}" show="{{endshow}}" mode="datetime" data-ref="enddatetimePicker" value="{{endvalue}}" data-event-opts="{{[['^close',[['e6']]],['^cancel',[['e7']]],['^confirm',[['endconfirm']]],['^input',[['__set_model',['','endvalue','$event',[]]]]]]}}" bind:close="__e" bind:cancel="__e" bind:confirm="__e" bind:input="__e" bind:__l="__l"></u-datetime-picker><view data-event-opts="{{[['tap',[['e8',['$event']]]]]}}" class="calendarinput" bindtap="__e"><text>失效时间</text><u-icon vue-id="{{('5fcb28c2-8')+','+('5fcb28c2-2')}}" size="25" name="calendar" bind:__l="__l"></u-icon></view><u-action-sheet vue-id="{{('5fcb28c2-9')+','+('5fcb28c2-2')}}" actions="{{Restrictiontype.list}}" title="{{Restrictiontype.title}}" cancelText="取消" show="{{Restrictiontype.show}}" data-event-opts="{{[['^select',[['RestrictiontypeClick']]],['^close',[['e9']]]]}}" bind:select="__e" bind:close="__e" bind:__l="__l"></u-action-sheet><view data-event-opts="{{[['tap',[['e10',['$event']]]]]}}" class="calendarinput" bindtap="__e"><text>{{Restrictiontype.value}}</text><u-icon vue-id="{{('5fcb28c2-10')+','+('5fcb28c2-2')}}" size="20" name="arrow-down" bind:__l="__l"></u-icon></view><input class="calendarinput" type="text" placeholder="优惠券名称" data-event-opts="{{[['input',[['__set_model',['','CouponName','$event',[]]]]]]}}" value="{{CouponName}}" bindinput="__e"/><input class="calendarinput" type="text" placeholder="优惠值" data-event-opts="{{[['input',[['__set_model',['','Discountvalue','$event',[]]]]]]}}" value="{{Discountvalue}}" bindinput="__e"/><u-action-sheet vue-id="{{('5fcb28c2-11')+','+('5fcb28c2-2')}}" actions="{{recovery.list}}" title="{{recovery.title}}" cancelText="取消" show="{{recovery.show}}" data-event-opts="{{[['^select',[['recoveryClick']]],['^close',[['e11']]]]}}" bind:select="__e" bind:close="__e" bind:__l="__l"></u-action-sheet><view data-event-opts="{{[['tap',[['e12',['$event']]]]]}}" class="calendarinput" bindtap="__e"><text>{{recovery.value}}</text><u-icon vue-id="{{('5fcb28c2-12')+','+('5fcb28c2-2')}}" size="20" name="arrow-down" bind:__l="__l"></u-icon></view><u-action-sheet vue-id="{{('5fcb28c2-13')+','+('5fcb28c2-2')}}" actions="{{Effectiveduration.list}}" title="{{Effectiveduration.title}}" cancelText="取消" show="{{Effectiveduration.show}}" data-event-opts="{{[['^select',[['EffectivedurationClick']]],['^close',[['e13']]]]}}" bind:select="__e" bind:close="__e" bind:__l="__l"></u-action-sheet><view data-event-opts="{{[['tap',[['e14',['$event']]]]]}}" class="calendarinput" bindtap="__e"><text>{{Effectiveduration.value}}</text><u-icon vue-id="{{('5fcb28c2-14')+','+('5fcb28c2-2')}}" size="20" name="arrow-down" bind:__l="__l"></u-icon></view><block wx:if="{{Effectiveduration.type==1}}"><input class="calendarinput" type="text" placeholder="固定时间(小时/单位)" data-event-opts="{{[['input',[['__set_model',['','timevalue','$event',[]]]]]]}}" value="{{timevalue}}" bindinput="__e"/></block><input class="calendarinput" type="text" placeholder="优惠券数量" data-event-opts="{{[['input',[['__set_model',['','Couponnumber','$event',[]]]]]]}}" value="{{Couponnumber}}" bindinput="__e"/><button data-event-opts="{{[['tap',[['confirm',['$event']]]]]}}" class="confirmbtn" bindtap="__e">确认</button></view></scroll-view></view></u-popup><view class="CouponList"><block wx:for="{{coupondata}}" wx:for-item="item" wx:for-index="index" wx:key="index"><view class="CouponList-item"><view class="header"><view class="Merchantname">{{'商家名称：'+item.p_name+''}}</view><view class="Couponname">{{'优惠券名称：'+item.name+''}}</view></view><view class="neck"><view class="Couponprice">{{'优惠值：'+item.discounts_rules+''}}</view><view class="repeattype">是否重复使用：</view></view><view class="time"><view class="statetime"><text>{{item.start_effective_time+"---"+item.end_effective_time}}</text></view></view><view class="allnumber"><view class="number">{{'发放数量：'+item.amount+''}}</view><view class="invalidnumber">无效数量：</view></view><view class="attributenumber"><view class="Usednumber">已使用数量：</view><view class="notusednumber">未使用数量：</view></view><view class="footer"><view class="Coupontype">{{'优惠券类型：'+(item.discounts_type=="0"?'免费':item.discounts_type=="1"?'定值':item.discounts_type=="2"?'打折':'金额充值')+''}}</view><view class="type">状态：</view></view><view class="btns"><text>编辑</text><text>发放</text><text>发放记录</text><block wx:if="{{item.time_type!=0}}"><text data-event-opts="{{[['tap',[['changecode',['$0'],['id']]]]]}}" bindtap="__e">二维码</text></block><text data-event-opts="{{[['tap',[['del',['$0'],[[['coupondata','',index,'id']]]]]]]}}" bindtap="__e">删除</text></view></view></block></view></view>